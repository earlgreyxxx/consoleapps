<?xml version="1.0" encoding="utf-8" ?>
<Models>
  <Model Name="tmweb">
    <Tables>
      <Table>stg_bibliography</Table>
      <Table>stg_collection</Table>
    </Tables>
    <Queries>
      <Query ClassName="Book">SELECT [collection_id],[collection_book_code],[collection_alternative_symbol],[collection_class_symbol_id],[collection_class_symbol_secondary_id],[collection_book_symbol],[collection_volume_symbol],[collection_mediatype_id],[collection_shelf_id],[collection_forbidden_category_id],[collection_interlibrary_category_id],[collection_interlibrary_import_library_id],[collection_interlibrary_import_collection_id],[collection_status_id],[collection_accept_book_id],[collection_uncertained_count],[collection_remarks],[collection_shelf_date],[collection_registdate],[collection_lastupdate],[bib_id],[bib_code],[bib_interlibrary_import_library_id],[bib_interlibrary_import_bib_id],[bib_material_id],[bib_language_id],[bib_alternative_symbol],[bib_class_symbol_id],[bib_class_symbol_secondary_id],[bib_book_symbol],[bib_volume_symbol],[bib_version],[bib_isbn],[bib_issn],[bib_magazine_code],[bib_frequency_id],[bib_book_title],[bib_book_title_yomi],[bib_book_subtitle],[bib_book_subtitle_yomi],[bib_series],[bib_series_yomi],[bib_origin],[bib_author],[bib_author_yomi],[bib_author_intro],[bib_note],[bib_general_subject],[bib_general_subject_yomi],[bib_personal_subject],[bib_personal_subject_yomi],[bib_content_intro],[bib_content_detail],[bib_publisher],[bib_publish_place],[bib_publish_year],[bib_page_nums],[bib_book_size],[bib_price],[bib_mark_id],[bib_mark_category_id],[bib_isbn_secondary],[bib_parent_bib_id],[bib_target_id],[bib_publish_country_code_id],[bib_work_language],[bib_no],[bib_volume_no],[bib_registdate],[bib_lastupdate],[status_code],[status_name],[forbidden_category_code],[forbidden_category_name],[material_id],[material_code],[material_name],[class_symbol_code],[class_symbol_secondary_code],[interlibrary_category_code],[lental_lending_status],[check_time],[shelf_name],[shelf_code],[archive_code],[archive_name],(SELECT COUNT([resv_id]) FROM [biz_reservation]  WHERE [resv_lent] IS NULL AND [resv_bib_id] = [bib_id]) AS resv_count FROM [stg_collection]  INNER JOIN [stg_bibliography] ON [bib_id] = [collection_bib_id] INNER JOIN [mst_material] ON [material_id] = [bib_material_id] LEFT JOIN [mst_shelf] ON [shelf_id] = [collection_shelf_id] LEFT JOIN [mst_archive] ON [archive_id] = [shelf_archive_id] LEFT JOIN [mst_class_symbol] ON [class_symbol_id] = [collection_class_symbol_id] LEFT JOIN [mst_class_symbol_secondary] ON [class_symbol_secondary_id] = [collection_class_symbol_secondary_id] INNER JOIN [mst_forbidden_category] ON [forbidden_category_id] = [collection_forbidden_category_id] INNER JOIN [mst_interlibrary_category] ON [interlibrary_category_id] = [collection_interlibrary_category_id] INNER JOIN [mst_status] ON [status_id] = [collection_status_id] LEFT JOIN [biz_lending] ON [lental_collection_id] = [collection_id] AND [lental_lending_status] = N'lending' LEFT JOIN [biz_check] ON [check_collection_id] = [collection_id]</Query>
    </Queries>
  </Model>
</Models>
